<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8">
        <title>view</title>
    </head>
    <body>
        <p>
            <a href="/">Главная</a>
        </p>

        <form action="view" id="view"  method="get">
           <p> 
               <input type="submit" value="Удалить"> 
           </p>
                <!--id="comment_list"-->       
                %(row)s         
        </form>

        <script type="text/javascript">
        
            var tableElem = document.getElementById('comment_list'); 
            var elements = tableElem.getElementsByTagName('input');

            var form = document.getElementById('view');
            form.onsubmit = function() {
               
                var xhr = new XMLHttpRequest();
                
                var commentsToDelete = [];

                for (var key in elements)
                {
                    if(elements[key].checked)
                    {
                        commentsToDelete.push(elements[key].id);
                    }
                }
   
                xhr.open('GET', '/delete_comments?comments_to_delete=' + commentsToDelete, true);

                xhr.send();

                xhr.onreadystatechange = function() {
                    if (xhr.readyState != 4) return;
        
                    if (xhr.status != 200) {
                        alert (xhr.status + ':' + xhr.statusText);
                     } else {
                       document.getElementById('comment_list').innerHTML = xhr.responseText;      
                     }        
                }
            }
        </script>

    </body>
</html>

